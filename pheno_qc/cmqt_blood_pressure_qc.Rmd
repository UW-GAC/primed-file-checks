
```{r}
# check file_name and df passed in 

# head(df)
# print(file_name)
```

```{r}
# Check for systolic blood pressure < diastolic blood pressure 

vars_df <- vars_df %>% add_row(
  vars = 'bp_consistency', 
  min = NULL, 
  max = NULL, 
  mean = NULL, 
  median = NULL,
  min_values = NULL, 
  max_values = NULL, 
  qc_pass = sum(this_table$systolic_bp_1 > this_table$diastolic_bp_1, na.rm=TRUE ), 
  qc_fail_min = sum(this_table$systolic_bp_1 <= this_table$diastolic_bp_1, na.rm=TRUE), 
  qc_fail_max = NULL, 
  qc_null = c(sum(is.na(this_table$systolic_bp_1) | is.na(this_table$diastolic_bp_1)))
)
```

General Variables: 

- age: 
  - QC Min: 0
  - QC Max: 90
- r vars
  - QC Min: -4SD outlier
  - QC Min: +4SD outlier
CMQT Blood Pressure Specific Variables: 

- bp_consistency: Is systolic > diastolic 
  - QC Min: NA
  - QC Min: NA
  - Pass QC: number of samples with systolic > diastolic
  - Fail QC Min: number of samples without systolic > diastolic
  - Fail QC Max: NA
  - Null Values: number of samples with null values for systolic_bp_1 or diastolic_bp_1
  
```{r}
kable(rbind(age_df, vars_df), col.names = c('Variable', 'Min Value', 'Max Value', "Mean", "Median", "QC Min", "QC Max", 'Pass QC', 'Fail QC Min', 'Fail QC Max', 'Null Values'))
```